# 对齐记录

---

## 2026-02-06 第一轮对齐

### 讨论背景
- 基于8张物理教材图片（静电场章节）分析学科学习结构
- 对照所有历史产品文档(v1~v1.1.4)，发现知识点层在迭代中丢失
- 用户已确认逻辑页三Tab：知识点 / 模型方法 / 高考卷子视角

### Q1: 三Tab知识树的通用层级框架
- ✅ 确认：强制三级
- ✅ 确认：知识点Tab和模型Tab的Level 1共用分类（按章）
- ✅ 确认：跨章节模型在所有相关章节都出现为节点，同一详情页

### Q2: 知识点和模型之间的关系
- ✅ 确认方案B：双向关联+AI诊断分流

### Q3: 知识点Tab的学习流程
- ✅ 确认方案A：预设内容+AI引导式讲解+概念检测

### Q4: 知识点掌握度
- ✅ 确认：6级（未发现→发现薄弱→多次薄弱→做对过→能解释→稳定掌握）
- "能解释"通过预设开放题+AI判定实现

### Q5: 快检题预设设计
- ⏸️ 暂停：等待课程转文字材料

---

## 2026-02-06 第二轮对齐

### 批量确认
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q6 | 概念检测触发场景 | A: 4个场景全做 |
| Q7 | 模型掌握度 | A: v1.1.4的6级 |
| Q8 | 高考Tab第三级 | C修订: 真题展示+上传卷子+切分题目 |
| Q9 | 主页改造 | B: 推荐区混合推荐 |
| Q11 | 知识点算闭环吗 | A: 不算 |
| Q12 | 模型详情页 | C: 前置知识点+智能提示 |
| Q14 | V1内容量 | 修订: 物理+数学全部章节 |
| Q15 | 注册问诊 | 保持不变(完整版/快速版) |

### 待深入讨论
| 编号 | 主题 | 状态 |
|------|------|------|
| Q10 | 训练体系全架构(六步的定位、错误结构→解决方案映射) | ⏳ 核心讨论中 |
| Q13 | 知识点详情页(做对的题放不放、错题目的、能否点击) | ⏳ 待回答 |
| — | 逻辑Tab改名 | ⏳ 待确认 |

### 文件修改
- 更新 core_framework_v2.0.md：写入Q6-Q15所有确认项（第七~十四节）
- 更新 记录文件.md

---

## 2026-02-06 第三轮对齐

### 批量确认 Q16-Q25 + Q27-Q28
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q16 | 闪卡新增卡片类型 | B: +概念卡+条件卡+辨析卡（共9种） |
| Q17 | Step 5作答方式 | C: 分步骤填空 |
| Q18 | 知识点学完自动生成闪卡 | A: 自动生成 |
| Q19 | 刷题中知识点角色 | C: 标签辅助（不单独出题） |
| Q20 | 快速开始含知识点吗 | C: 含但低优先级 |
| Q21 | 粗心消杀触发 | B: 推送+主动入口 |
| Q22 | 诊断最大轮数 | B: 最多5轮（非3轮，更精准） |
| Q23 | 模型Level 3交互 | B: 跳到详情页锚点 |
| Q24 | 卷子上传入口 | B: 高考Tab单独上传 |
| Q25 | 社区Tab | A: 保持原设计三Tab + 多一个标签 |
| Q27 | "选项穷举"训练融入六步 | A: 融入Step 1(识别)和Step 2(决策) |
| Q28 | 一级/二级结论概念引入 | A: 引入，作为知识点属性 |

### 追加确认 Q26 + Q29
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q26 | 预测系统V1定位 | C: 预测驱动个性化路径(GPS导航)，V1粗粒度版。有近10年真题，按最近1-2年结构映射 |
| Q29 | 分数预测展示方式 | A+C: 独立预测中心(入口进入) + 关键节点触发(+3分即时反馈) |

### 待深入讨论（本轮已结束，见第四轮）

### 文件修改
- 更新 core_framework_v2.0.md：写入Q16-Q29所有确认项
- 写入Q26预测系统核心定位 + Q29展示方式
- 更新 记录文件.md

---

## 2026-02-06 第四轮对齐

### 批量确认 Q30 + Q10 + Tab名 + Q13
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q30-上传 | 每日上传机制 | A: 极简上传（拍照+标对错，约3分钟/天） |
| Q30-遗忘 | 遗忘保护策略 | 乐观为主：14天无数据→建议复习，28天→可能遗忘，**只有做错才降级** |
| Q10a | 六步闭环显性化 | B: 半显性（日常隐藏，周复盘展示闭环数据） |
| Q10b | 知识点解决方案 | B: 统一流程AI动态调（需后续设计动态调节决策树） |
| Q10c | 首次学模型Step 5 | A: 预设母题（需设计好动态调节流程） |
| Tab名 | 逻辑Tab改名 | "全局" |
| Q13 | 知识点详情页 | 状态仪表盘+学习入口，不放题目 |

### 追问
- Q13追问："那错题和对的题在哪呢，为什么在那？" → 见第五轮

### 文件修改
- 更新 core_framework_v2.0.md：写入Q30完整方案、Q10六步闭环、Tab名改"全局"、Q13详情页
- 更新 记录文件.md

---

## 2026-02-06 第五轮对齐

### Q13追问解决 + Q31/Q32/Q33确认
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q13归属 | 题目归属规则 | 题目主归属=模型，知识点=标签，高考题号=来源。知识点页不放题 |
| Q31 | 错题本 | 不做独立错题本。统一"+"上传→统一历史页→筛选"错题"=智能错题本 |
| Q32 | 周复盘页 | 方向C(数据+AI策略+计划)。V1保守版：只做Top3优先级+策略，不排每日计划。**推荐不准宁可不推荐** |
| Q33 | 每日上传UX | A: 拍照+手动标。与作业上传**合并为同一流程**，只是标签不同 |

### 关键设计决策
- 主页"+"按钮统一3种上传：作业 / 极简上传(练习) / 考试卷子
- 统一上传历史页 = 错题本 + 对题本 + 学习日记
- 周复盘页V1质量原则：80分以下不做，数据不足不硬推

### 文件修改
- 更新 core_framework_v2.0.md：新增第三十节(统一上传体系)、第三十一节(周复盘页)
- 更新主页结构（第十节）：加入"+"按钮和上传历史入口
- 更新 记录文件.md

---

## 2026-02-06 第六轮对齐

### 确认 Q34 + Q35 + Q36
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q34 | 上传题目识别匹配 | 大模型打标签，~0.1元/次，已解决 |
| Q35 | AI动态调节架构 | 路由层=纯规则(if-else读标签,0成本) + 对话层=大模型调用(~0.1元/次) |
| Q36 | 预测中心vs高考Tab | B: 预测中心=总分+趋势+路径，题号级预测叠加到高考Tab聚合页 |

### 关键架构决策
- 系统两层：路由层(规则) + 对话层(大模型)
- 预测中心不重复高考Tab的题号视角，各司其职
- 成本：知识点学习0.3-0.5元/次，模型训练0.4-0.6元/次

### 文件修改
- 更新 core_framework_v2.0.md：写入两层架构+路由规则、预测展示分工
- 更新 记录文件.md

### 当前待讨论
- Q5: 快检题预设设计（等待课程转文字材料）
- 其余核心框架设计已基本完成

---

## 2026-02-06 第七轮对齐（课程洞察第一轮）

### 确认 Q37 + Q38 + Q39 + Q40 + Q41
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q37 | 公式主语错误归类 | B: 作为"模型应用缺口"的子类（识别错/决策错/步骤错/主语错），AI诊断增加检查维度 |
| Q38 | 模型族结构化 | C: 不做结构化，模型保持独立节点，联系仅帮助记忆，AI口头提及即可 |
| Q39 | 过程中的转折判断 | 用户深化：核心是"过程拆分+主语确定"，Step 1升级为"过程拆分+模型识别"，每个公式必须对应确定过程+确定主语 |
| Q40 | "不敢写"检测 | AB: 既教穷举策略，又做行为检测（>90秒不输入触发鼓励+方法提示） |
| Q41 | 热身机制 | 不做。做不会就靠现有路由降级，隐式热身 |

### 关键设计决策
- 六步改为：**过程拆分+识别→决策→步骤→陷阱→回归→变式**
- "主语错"成为模型应用缺口的第4个子类
- 模型不做族群化，保持扁平独立
- 路由自动降级 = 隐式热身，不额外做

### 文件修改
- 更新 core_framework_v2.0.md：写入Q37-Q41所有确认项
  - Section 五（六步训练）：Step 1升级、Step 5增加不敢写检测
  - Section 二（AI诊断）：增加主语错子类和检查维度
  - 新增 Section 三十二（模型族不做）
  - 新增 Section 三十三（过程拆分与主语确定）
  - 新增 Section 三十四（不敢写检测+穷举引导）
  - 新增 Section 三十五（热身不做）
- 更新 记录文件.md

---

## 2026-02-06 第七轮对齐（课程洞察第二轮）

### 确认 Q42 + Q43 + Q44 + Q45 + Q46
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q42 | 稳定掌握判定 | B: 靠变式题自然筛掉假会，不加额外解释环节 |
| Q43 | 易混模型对比表 | 确认：教研预设易混组+对比表，AI检测到混淆时自动展示，辨析卡联动闪卡 |
| Q44 | 过程拆分独立训练 | 确认：独立审题训练模块（过程重述），作为模型训练前置基础能力 |
| Q45 | 粗心细分 | A: 细分记录（计算错/符号错/审题错/抄错），V1仅记录+周复盘提醒 |
| Q46 | 预测稳定性 | 用户深化：一次对一次错=分析不够细，需要深度诊断找更小粒度错误，不稳定模型按current_level预测 |

### 关键设计决策
- 新增独立"审题训练模块"：过程重述，4步结构化（几个过程→主语→特征→转折点）
- 易混模型用预设对比表解决，触发条件=教研预设易混组+AI诊断匹配
- 不稳定检测（最近4次正确率25%-75%）→ 深度诊断模式（找更小粒度错误）
- 粗心4子类仅记录不训练（V1）

### 文件修改
- 更新 core_framework_v2.0.md：
  - Section 五（错题闭环）：增加粗心细分、审题错分路
  - 新增 Section 三十六（掌握度稳定性判定+深度诊断）
  - 新增 Section 三十七（易混模型对比表）
  - 新增 Section 三十八（审题训练模块）
  - 新增 Section 三十九（粗心细分记录）
- 更新 记录文件.md

---

## 2026-02-06 第七轮对齐（课程洞察第三轮）

### 确认 Q48 + Q49 + Q51
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q48 | 一级/二级结论 | 二级结论=知道来源+记住何时用（纯记忆），简化3步流程，跳过深入理解 |
| Q49 | 跨模型错误模式 | A: V1靠周复盘+高考视角找宏观规律，不做自动跨模型分析 |
| Q51 | AI人格 | B: 全局基础人格+按模块微调（诊断温和/训练严格/复盘鼓励） |

### 深入讨论中
| 编号 | 主题 | 状态 |
|------|------|------|
| Q47 | 审题训练触发条件 | 用户要求详细展开学生状态映射 |
| Q50 | 快检题触发时机 | 用户要求详细展开学生模型状态 |

### 文件修改
- 更新 core_framework_v2.0.md：
  - 新增 Section 四十（一级/二级结论学习路径）
  - 新增 Section 四十一（跨模型错误V1策略）
  - 新增 Section 四十二（AI人格设定）
- 更新 记录文件.md

---

## 2026-02-06 第七轮对齐（Q47+Q50深入确认）

### 确认 Q47 + Q50
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q47 | 审题训练触发逻辑 | 确认：只在"做错题分流+诊断=主语错/识别错+审题正确率<60%"时触发，新增reading_accuracy标签 |
| Q50 | 快检题完整设计 | 确认A：测识别能力，1题30秒，仅在peak>0且last_active>14天且非做错题场景时触发 |

### 关键变更
- **久未练习阈值统一改为14天**（原部分描述为7天）
- 模型6步路由规则升级：增加快检路径 + 审题训练插入判断
- Q5（快检题预设设计）与Q50合并解决

### 文件修改
- 更新 core_framework_v2.0.md：
  - 模型6步路由规则（Section十六）：增加快检分支+审题训练分支
  - Section 三十八（审题训练）：写入完整触发逻辑+状态映射+标签字段
  - 新增 Section 四十三（快检题完整设计）
- 更新 记录文件.md
- 开始全框架算法审计

---

## 2026-02-06 全框架算法审计

### 审计范围
逐行审读 core_framework_v2.0.md（1200+行），检查所有分类逻辑、路由规则、算法是否清晰到"开发者看文字就能实现后台"。

### 发现并修复的问题

| # | 问题 | 位置 | 修复方式 |
|---|------|------|---------|
| 1 | **标签字段不完整**：只写了3个字段(current_level/peak_level/last_active)，缺少error_count/correct_count/recent_results/weak_step/is_unstable等实际路由需要的字段 | Section 二十九 | 扩展为完整标签字段集（13个字段） |
| 2 | **知识点5步路由缺少conclusion_level分流**：Q48确认了一级/二级结论走不同流程，但路由规则没体现 | Section 十六 知识点路由 | 路由规则增加conclusion_level判断分支 |
| 3 | **知识点路由缺少last_active>14天分支**：模型有快检，但知识点久未练习的入口没写 | Section 十六 知识点路由 | 增加"久未练习→直接进Step 4检测"分支 |
| 4 | **模型掌握度表"解释对"含义不明**：L3写"对1次+解释对"但没说什么是模型的"解释" | Section 八 | 改为"Step 5回归题做对"，明确升级只在训练内触发 |
| 5 | **预测算法缺失**：只有文字描述"遍历→查→估算"，没有伪代码 | Section 二十七 | 增加完整预测算法伪代码+level_to_prob映射表 |
| 6 | **每日上传后的标签更新逻辑缺失**：写了"更新current_level和last_active"但没写怎么更新 | Section 二十九 | 增加完整的上传后处理算法（对/错分别怎么更新） |
| 7 | **标签更新总算法缺失**：没有一个地方汇总"什么事件触发什么标签变化" | Section 二十九 | 新增"标签更新算法"汇总（5类触发事件） |
| 8 | **闭环计数规则不明**：只说"闭环仅算错题分析/刷题"但具体+1条件不清楚 | Section 十一 | 增加详细的闭环计数规则 |
| 9 | **模型训练6步缺少prompt模板**：知识点有prompt模板，周复盘有，但模型训练没有 | Section 十九 | 增加模型训练AI提示词模板 |
| 10 | **模型训练Step 3/4交互方式不明**：Step 1/2/5有详细描述，Step 3(步骤)/4(陷阱)没有 | Section 十九 | 增加6步完整交互方式表+Step 3/4描述 |
| 11 | **主页推荐区排序算法缺失**：只说"混合推荐"但不知道怎么排序 | Section 十 | 增加推荐排序算法（优先级+候选池来源） |
| 12 | **注册问诊如何初始化标签**：只说"5选择+5大题"但问诊结果怎么转化为初始掌握度 | Section 十四 | 增加问诊结果→标签初始化逻辑 |
| 13 | **不稳定标记退出条件缺失**：写了何时标记为不稳定，没写何时恢复 | Section 三十六 | 增加退出条件（连续3次做对→恢复） |
| 14 | **深度诊断prompt模板缺失** | Section 三十六 | 增加深度诊断AI提示词模板 |
| 15 | **闪卡自动生成时机不完整**：只写了知识点学完生成，没写模型训练各步也生成 | Section 十五 | 补充模型训练每步+易混对比表触发生成 |
| 16 | **SM-2算法只提名字没写规则** | Section 十五 | 增加SM-2完整伪代码 |
| 17 | **数据模型缺失**：没有题目、学生、易混组的数据结构定义 | 无 | 新增"完整数据模型一览"Section |

### 结论
- 修复后，所有路由规则都有可执行的伪代码/决策树
- 所有标签字段有完整定义+更新规则
- 所有AI调用有prompt模板
- 所有算法（预测/SM-2/排序/闭环计数）有伪代码
- **后端开发者现在可以仅凭此文档实现全部后台逻辑**

---

## 2026-02-07 第二次全框架审计

### 审计发现
子代理审计发现52个问题（20后端+25 PM/UI+7跨章节不一致）

### 修复内容

#### 跨章节不一致修复（7项）
| # | 问题 | 修复 |
|---|------|------|
| 46 | L5升级条件"闪卡稳定"在标签算法中缺失 | 删除"闪卡稳定"要求，统一为"多次解释正确(≥2,间隔≥24h)" |
| 47 | 快检降级L1→L0的边界问题 | 添加全局规则"降级下限=L1，不降到L0" |
| 48 | conclusion_level在久未练习场景缺处理 | 知识点路由已覆盖所有conclusion_level分支 |
| 49 | 做错题分流+久未练习的路由优先级冲突 | 模型路由改为4级优先级明确排序，做错题优先于久未练习 |
| 50 | 上传标"对"直接升L3与训练升级矛盾 | 删除L0→L3例外，上传标"对"永远不改level |
| 51 | 粗心子类存储方式不明 | error_subtype枚举增加完整子类定义 |
| 52 | 知识点是否有is_unstable不明 | 明确：仅模型有is_unstable，知识点固定为false |

#### 算法边界修复
- "不同时间"全局定义：间隔≥24小时
- 标签更新算法拆分为：训练做对/训练做错/上传标对/上传标错 四条独立路径
- 模型路由规则改为4级优先级，消除所有优先级冲突

#### PM/UI补充
- 新增 Section 四十四：完整页面清单（19个页面+5个弹窗）+ 导航地图 + 跳转条件表 + 通用交互规范
- 新增 Section 四十五：AI提示词变量参考表（22个变量的类型/来源/示例值）

### 文件修改
- 更新 core_framework_v2.0.md：跨章节修复 + 新增Section四十四/四十五
- 更新 记录文件.md
- 生成 audit_report.md（审计原始报告，可删除）

---

## 2026-02-07 第八轮对齐（课程洞察+注册流程重构）

### 背景
- 综合5名学生的课堂记录洞察（王浚/张可心/河西），提出5个关键优化问题（Q52-Q56）
- 核心发现：注册流程应以目标分数驱动，诊断结果应关联具体题号得分影响

### 确认 Q52B + Q53B + Q54B + Q55B
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q52 | 注册流程重构 | B: 三步走（目标分数→卷面策略生成→自适应AI诊断），替代原静态"5+5"/"10+解释"问诊 |
| Q53 | 首次诊断方式 | B: AI对话+简单题自适应诊断，根据卷面策略中🔴必须拿满的关联模型优先出题 |
| Q54 | 诊断结果话术 | B: 三段式输出（①问题定位→②可解决性/不难→③目标分影响+X分），写入AI prompt模板 |
| Q55 | 代入错分类 | B: 新增"代入错"(substitution_wrong)为模型应用缺口第5个子类，区别于步骤错和粗心计算错 |

### Q56 讨论中
- 用户提问：自有题库标定卷面位置没问题，但学生上传的题目（作业/模拟卷）如何实现？
- 核心问题：一道上传题需处理几次？每次提取什么？中国各地区卷面结构不同如何处理？
- 状态：提出处理流水线方案，待用户确认

### 关键设计变更
1. **注册流程完全重构**：
   - 新增概念：地区卷面结构模板（region_exam_structure）
   - 新增概念：卷面策略表（exam_strategy，三级态度🔴🟡⚪）
   - 新增概念：三维初始画像（formula_memory_rate / model_identify_rate / calculation_accuracy）
   - 诊断从"静态出题"变为"基于卷面策略关联模型动态出题"
   - 做错但会公式只是算错/代入错 → current_level=2（区别于完全不会的L1）

2. **AI诊断输出格式升级**：
   - 所有诊断结果强制三段式（问题→可解决→分数影响）
   - prompt模板新增 {target_score} 和 {exam_strategy} 变量

3. **错误分类新增"代入错"**：
   - 定义：公式结构正确但物理量代入错误（搞混V₀和V、用错过程的量）
   - 枚举：substitution_wrong
   - AI诊断增加检查维度："这个字母代的是哪个物理量？是哪个过程的？"

4. **学生全局标签扩展**：
   - 新增：region_id, target_score, exam_strategy, formula_memory_rate, model_identify_rate, calculation_accuracy
   - 删除：registration_type（被新流程替代）

5. **页面清单新增注册页**：R1基础信息 / R2卷面策略 / R3自适应诊断

### 文件修改
- 更新 core_framework_v2.0.md：
  - Section 十四：完全重写注册流程
  - Section 二：诊断prompt增加代入错子类+三段式输出格式
  - Section 五：错题闭环增加代入错子类
  - Section 二十九：error_subtype枚举增加substitution_wrong
  - Student数据模型：增加6个新字段
  - Section 四十四：P14更新为三段式结果卡片，新增R1/R2/R3注册页
  - 新增 Section 四十六：地区卷面结构模板（待Q56确认后完善）
- 更新 记录文件.md

---

## 2026-02-07 第八轮对齐（续：Q56-Q60讨论）

### 确认 Q58C + Q59B
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q58 | 目标分数变更处理 | C: 重算策略表 + 弹出"目标变更引导"展示新旧差异 + 推荐自动重排 |
| Q59 | 首周冷启动推荐 | B: 诊断暴露+🔴关联未测模型自然穿插推荐，7天后回归正常逻辑 |

### 深入讨论中
| 编号 | 主题 | 状态 |
|------|------|------|
| Q56 | 上传题目处理流水线（情况A实现细节） | 用户要求展开讨论 |
| Q57 | 自适应诊断的城市特异性路径 | 用户提出天津示例，要求详细设计每个城市的诊断路径 |
| Q60 | 三维画像的具体作用与AI更新成本 | 用户要求详细解释 |

### 文件修改
- 更新 core_framework_v2.0.md：
  - Section 十四新增"目标分数变更处理"子节（Q58C）
  - Section 十新增"首周冷启动推荐策略"子节（Q59B）
- 更新 记录文件.md

---

## 2026-02-07 第八轮对齐（续2：Q56-Q60深入+12份课程记录分析）

### 确认 Q57B
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q57 | 自适应诊断路径 | B: 必须人工设计。城市+科目+分数档=一份模板。天津示例：tier1(板块/碰撞/电磁/单棒/磁流体)→tier2(平抛/圆周/斜面)→tier3可选(天体/光学/原子/热力学) |

### Q56/Q60 深入讨论
- Q56：卷面上传交互细节已写入Section四十七（标准结构走快速映射0成本，非标准走AI识别），新增"半对"处理规则
- Q60：讨论公式记忆度的测量方式（先文字输入而非选择题，AI判定~0.05元/次）、计算错误的判断方法

### 用户提出四大研究方向
基于12份课程记录（王浚5份+苏歆然6份+王雨萱1份），用户重新定义产品核心为4件事：
1. **状态可视化**：学生和家长如何清晰看到掌握状态（像电影一样）
2. **我们的题测试**：如何通过我们题库最大化测试/更新学生状态
3. **学生的题更新**：如何通过学生上传的题目测试/更新状态
4. **状态驱动推荐**：如何根据状态推荐后续行为

### 关键设计变更
1. Section四十六完全重写：人工设计的分数策略模板（城市+科目+分数档）
2. 新增Section四十七：考试卷子上传完整交互流程（情况A快速映射+情况B AI识别+半对处理）
3. UI要求升级："像电影一样"的策略展示页——卷面全景图+模型掌握地图+动画过渡

### 文件修改
- 更新 core_framework_v2.0.md：
  - Section 四十六：完全重写为人工分数策略模板（Q57B）
  - 新增 Section 四十七：考试卷子上传交互细节（Q56）
- 更新 记录文件.md

---

## 2026-02-07 第九轮对齐（Q63-Q67：四层漏斗+L0-L5融合重构）

### 核心决策：融合，不叠加
用户明确要求："不要什么4层又6层的，要结合起来。我们还在设计阶段，修改成本不大。"
→ 将课程洞察中的"四层漏斗"（建模→列式→执行→稳定）直接融入L0-L5定义，不做两个并行系统。

### 确认结果
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q63 | 四层漏斗 vs L0-L5 | **融合重构**：L1-L3直接编码瓶颈层（L1=建模卡住/记不住，L2=列式卡住/理解不深，L3=执行卡住/使用出错），L4=做对过，L5=稳定掌握。一个系统，不是两个。 |
| Q64 | 分步骤训练 | **已被Q63解决**：Level就是入口，L1→Step 1, L2→Step 2, L3→Step 3-5。"分步骤训练"不再是独立概念，而是路由规则的自然结果。 |
| Q65 | 上传题目四层诊断 | C: AI诊断输出升级为"四层逐层定位"（建模✅/❌ → 列式✅/❌ → 执行✅/❌）+ 三段式话术 |
| Q66 | 延时复测机制 | 融入Section八：L4后自动安排变式复测（3d/7d/30d），全过→L5，失败→精确降到出错的层。新增`next_retest_date`字段。 |
| Q67 | 公式recall成本 | C+成本修正：自适应recall→recognition切换，recall判定成本~0.001元/次（非0.05元，用户确认prompt极短），10次≈1分钱 |

### 文件修改（core_framework_v2.0.md）
1. **Section 六（知识点掌握度）完全重写**：L1=记不住，L2=理解不深，L3=使用出错。新增"知识点三层含义"表（给家长看）+ recall测试机制（Q67C）
2. **Section 八（模型掌握度）完全重写**：L1=建模卡住，L2=列式卡住，L3=执行卡住。新增"四层含义"表 + 延时复测机制（Q66）+ 统一对比表
3. **模型6步路由规则重写**：Level即入口，废弃weak_step概念。L1→Step 1, L2→Step 2, L3→Step 3。降级精确到出错的层，不再一律回L1。
4. **知识点路由规则更新**：按新Level含义路由（L1→Step 2记忆, L2→Step 3理解, L3→Step 4使用）
5. **注册初始化标签更新**：做对→L4（做对过），识别错→L1，公式错→L2，执行错→L3
6. **AI诊断输出格式升级（Q65C）**：三段式扩展为"四层逐层定位+三段式话术"
7. **后端标签更新**：废弃`weak_step`字段，新增`next_retest_date`字段
8. **标签更新算法全面重写**：
   - 训练做错→精确降到出错的层（不再盲降L1）
   - 上传标错→暂不降级，等AI诊断后精确降
   - 训练做对→按层升级（可跨级）
   - 快检失败→直接降到L1（建模层出错）
   - AI诊断完成→四层定位结果更新level
9. **快检后路由更新**：匹配新系统

### 废弃概念
- `weak_step`字段：Level本身编码了瓶颈层，不再需要额外字段
- "发现薄弱/多次薄弱/发现问题/多次错"：旧Level名称，被"记不住/理解不深/使用出错/建模卡住/列式卡住/执行卡住"替代
- "一律降到L1"：盲降逻辑被精确降级替代

---

## 2026-02-07 第十轮对齐（Q68-Q72：可视化+超时+依赖+预测）

### 目标对齐
用户要求重新对齐项目目标。核心确认：
- **产品**：高三AI物理/数学辅导app，月付500-1000元/科
- **三个卖点**：A.状态可视化(需求5.0) + B.题号视角(唯一) + C.四层诊断(唯一壁垒)
- **四个研究方向**：状态可视化 / 我们的题测试 / 学生的题更新 / 状态驱动推荐
- **当前阶段**：设计文档打磨（9轮对话已覆盖完整系统架构），尚需细化可视化、预测算法、依赖处理

### 确认结果
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q68 | 状态可视化展示 | C: 双层展示——主页=卷面热力图（家长看）+ 模型详情=漏斗图（学生看） |
| Q69 | 上传错题未诊断超时 | B: 3天内软引导推荐，3天后未诊断→保守降到L3（执行层，最常见出错层），补诊断后修正 |
| Q70 | 延时复测等待期利用 | C: 优先推其他薄弱模型 + 穿插同族模型巩固（需教研预设模型关联图），前期可行因为L4模型少 |
| Q71 | 跨模型依赖 | C: 自适应检测——不阻拦进入，Step 1中检测前置缺口→弹出跳转建议→完成后返回。最多嵌套1层。 |
| Q72 | 预测分数算法 | 完整重写：每项数据标注来源，level_to_prob分模型/知识点独立设置，新增error_subtype±5%微调，新增未诊断错题折扣，新增校准方法 |

### 用户额外要求
- Q72："所有的算法必须要写清楚从用户数据到判断标准都是从哪来"→ 已落实为通用原则，Section五十二是示范

### 文件修改（core_framework_v2.0.md）
1. 新增 Section 四十八：状态可视化设计（双层展示：卷面热力图+漏斗图）
2. 新增 Section 四十九：上传错题未诊断超时处理（3天→默认L3）
3. 新增 Section 五十：延时复测等待期利用策略（推薄弱+同族串联）
4. 新增 Section 五十一：跨模型依赖处理（自适应检测+跳转机制）
5. 新增 Section 五十二：预测分数算法完整重写（数据来源追溯版）
6. 旧预测算法（Section 二十七）标注已被Section五十二替代

---

## 2026-02-07 第十一轮对齐（Q73-Q77：教研范围+定价+分销+品牌）

### 战略级决策
1. **定价**：诊断500元（独立产品）+ 升级到高考前3000元（一次付清）
2. **分销**：不自己卖，走渠道（机构小老师/家长口碑/教育组织）
3. **品牌**：需要设计让10秒说清楚的核心品牌概念（待设计）
4. **教研范围**：V1双城集（天津+另一城市），5-6周教研

### 确认结果
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q73 | V1教研范围 | C: 双城集（天津+另一城市验证通用性），5-6周 |
| Q74 | Aha Moment | C: 卷面策略(2min) + 四层诊断(20min) 双击。诊断本身独立卖500元，升级3000元 |
| Q75 | 周复盘内容 | C: AI叙事总结(给家长截图) + Level变化表 + 预测分变化 + Top 3推荐 |
| Q76 | 算法清晰度 | B+字典：全部算法补数据来源。涉及外部流程（卷子上传等）通过提问获取，不独立设计 |
| Q77 | 销售策略 | 走渠道分销：机构小老师(佣金)+家长口碑(老带新)+教育组织合作。不做独立家长端，做H5只读分享页 |

### 用户关键洞察
- "不愿意花这个钱做诊断的，后面也不花" → 诊断=付费筛选器
- "高三就剩三个月，没时间试" → 不做月付，一次3000到高考
- "让他们觉得这是对学生好的产品" → 不是推销，是推荐
- "算法你不要自己写，通过提问获得信息" → 外部流程算法采用Q&A方式

### 文件修改（core_framework_v2.0.md）
1. 新增 Section 五十三：定价模型（诊断500+升级3000）+ 诊断报告设计要求
2. 新增 Section 五十四：周复盘详细内容（叙事+Level表+预测+推荐）
3. 新增 Section 五十五：分销策略与渠道设计（三类渠道+佣金+H5分享页）
4. 新增 Section 五十六：算法清晰度原则（通用标准+待补充清单）

---

## 2026-02-07 第十二轮对齐（Q78-Q82 + 推荐算法完整设计）

### 用户核心指导
- "先把系统设计完善，根据能做出的好产品定义宣传，不是根据宣传做产品"
- "你先理解整个系统的信息流转，已经是十分复杂了，你要抓住最核心的矛盾"
- "500和3000一起做，社区再说"

### 确认结果
| 编号 | 主题 | 确认结果 |
|------|------|---------|
| Q78 | 品牌概念 | 暂缓——先把系统做好，品牌从产品中提炼。500版本方向="最清晰的掌握状态"，待确定 |
| Q79 | 诊断报告体验 | C: 动态揭晓(60s CSS动画逐步展示) + 静态报告页(截图分享用) |
| Q80 | 渠道佣金 | A: 高佣金（诊断40%=200元, 升级25%=750元），前期渠道动力最重要 |
| Q81 | 推荐排序算法 | 自主设计完整版：4层优先级(复测>诊断>提分优化>探索) + priority_score公式(提分影响×紧迫性/时间) |
| Q82 | V1开发范围 | 500+3000一起做，砍掉社区Tab，核心功能全做 |

### 核心矛盾发现
系统的核心矛盾 = **"所有数据汇入一个决策：接下来20分钟做什么最能提分？"**
- 数据采集层（注册/诊断/上传/训练）→ 产生学生状态
- 数据处理层（标签/预测）→ 计算Level和预测分
- 展示层（热力图/漏斗/报告）→ 让人看到状态
- **决策层（推荐引擎）→ 唯一做"选择"的地方**
→ 优先级公式 = (提分影响+依赖加成) × 紧迫系数 × 新鲜系数 / 所需时间

### 文件修改（core_framework_v2.0.md）
1. **Section 十 推荐排序算法完全重写**：4层Tier + priority_score公式 + 完整数据追溯
2. Section 五十三更新：Q82开发策略（500+3000一起做，砍社区）
3. Section 五十三新增：Q79C诊断报告动态揭晓+静态报告体验设计

### 过程要求变更
- Q76B确认：涉及外部流程的算法（卷子上传等），不独立设计，通过提问获取用户信息
- Q78暂缓：品牌概念等系统设计完善后再从产品中提炼
